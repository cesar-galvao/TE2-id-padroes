#| fig-height: 3
# gráfico
ggplot() +
geom_point(data = iris2[iris2$partition == "teste",], aes(x = Petal.Length, y = Petal.Width, color = Species), shape = 8) +
geom_point(data = iris2[iris2$partition == "treino",], aes(x = Petal.Length, y = Petal.Width, color = Species), shape = 16) +
theme_bw() +
labs(x = "Petal.Length",
y = "Petal.Width",
color = "Espécie",
shape = "Partição")
#| label: tbl-knniris
#| tbl-cap: Classificação dos pontos de teste do conjunto de dados iris.
treino <- iris2 %>% filter(partition == "treino")
teste <- iris2 %>% filter(partition == "teste")
knn3 <- knn(train = treino[, c(1,2)],
test = teste[, c(1,2)],
cl = treino$Species,
k = 3)
knn5 <- knn(train = treino[, c(1,2)],
test = teste[, c(1,2)],
cl = treino$Species,
k = 5)
data.frame(
teste$Species,
knn3,
knn5
) %>%
knitr::kable(
col.names = c("Espécie real", "k = 3", "k = 5")
)
#| label: fig-knniris
#| fig-cap: Classificação dos pontos de teste do conjunto de dados iris.
#| fig-height: 5
#| fig-width: 6.5
#| echo: false
base <- ggplot(iris2, aes(x = Petal.Length, y = Petal.Width, color = Species)) +
geom_point(alpha = 0.4, shape = 16) +
theme_bw() +
labs(x = "Treino",
y = "",
color = "Espécie")+
theme(legend.position = "none")
knnteste <- teste %>%
mutate(knn3 = knn3, knn5 = knn5)
plotknn3 <- base +
geom_point(data = teste, aes(color = knn3), shape = 8, size = 2.75)+
labs(x = "knn3", y = "")
plotknn5 <- base +
geom_point(data = teste, aes(color = knn5), shape = 8, size = 2.75)+
labs(x = "knn5", y = "")
plot_grid(
plot_grid(plotknn3, plotknn5,nrow = 1, ncol = 2),
plot_grid(NULL, base, NULL, nrow = 1, rel_widths = c(0.5, 1, 0.5)),
nrow = 2)
# Carregando o conjunto de dados iris
data(iris)
# Função para calcular a densidade e criar um data frame
calcular_densidade <- function(x) {
est_densidade <- ks::kde(x = x)
data.frame(x = est_densidade$eval.points, y = est_densidade$estimate)
}
# Calculando a densidade para cada variável
densidade_sepal_length <- calcular_densidade(iris$Sepal.Length)
densidade_sepal_width <- calcular_densidade(iris$Sepal.Width)
densidade_petal_length <- calcular_densidade(iris$Petal.Length)
densidade_petal_width <- calcular_densidade(iris$Petal.Width)
# Adicionando a variável correspondente ao data frame
densidade_sepal_length$Variable <- "Sepal.Length"
densidade_sepal_width$Variable <- "Sepal.Width"
densidade_petal_length$Variable <- "Petal.Length"
densidade_petal_width$Variable <- "Petal.Width"
# Combinando todos os data frames
densidade_total <- rbind(densidade_sepal_length, densidade_sepal_width, densidade_petal_length, densidade_petal_width)
# Plotando a densidade estimada
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(title = "Estimativa de Densidade Kernel",
x = "Valor da Variável",
y = "Densidade") +
theme_minimal() +
theme(legend.title = element_blank())
#| label: sepala
# Selecionando duas colunas para análise multivariada para dados de Sépala
sep<- as.matrix(iris[, 1:2])
# Estimando a densidade usando kernel para dados multivariados
est_densidade_multivariada_sep <- kde(x = sep, compute.cont = TRUE)
# Obtendo os pontos de avaliação e a densidade estimada
eval_points_sep <- expand.grid(est_densidade_multivariada_sep$eval.points[[1]], est_densidade_multivariada_sep$eval.points[[2]])
density_sep <- as.vector(est_densidade_multivariada_sep$estimate)
densidade_df_sep <- data.frame(eval_points_sep, density_sep)
# Renomeando colunas
colnames(densidade_df_sep) <- c("Sepal.Length", "Sepal.Width", "Density")
#| label: fig-densidadeiris2
#| fig-cap: Estimativa de densidade kernel multivariada para as variáveis de sépala do conjunto de dados iris.
#| fig-height: 3
# Visualizando a densidade estimada para duas dimensões com GGPLOT
ggplot(densidade_df_sep, aes(x = Sepal.Length, y = Sepal.Width, fill = Density)) +
geom_tile() +
labs(title = "Estimativa de Densidade Kernel Multivariada",
x = "Sepal Length",
y = "Sepal Width") +
scale_fill_gradient(low = "white", high = "blue") +
theme_minimal()
#| label: fig-densidadeiris
#| fig-cap: Estimativa de densidade kernel para as variáveis do conjunto de dados iris.
#| fig-height: 3
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_minimal() +
theme(legend.title = element_blank())
#| label: petala
### Pétala
# Selecionando duas colunas para análise multivariada para dados de Sépala
pet <- as.matrix(iris[, 3:4])
# Estimando a densidade usando kernel para dados multivariados
est_densidade_multivariada_pet <- kde(x = pet, compute.cont = TRUE)
# Obtendo os pontos de avaliação e a densidade estimada
eval_points_pet <- expand.grid(est_densidade_multivariada_pet$eval.points[[1]], est_densidade_multivariada_pet$eval.points[[2]])
density_pet <- as.vector(est_densidade_multivariada_pet$estimate)
densidade_df_pet <- data.frame(eval_points_pet, density_pet)
# Renomeando colunas
colnames(densidade_df_pet) <- c("Petal.Length", "Petal.Width", "Density")
#| label: fig-densidadeiris3
#| fig-cap: Estimativa de densidade kernel multivariada para as variáveis de pétala do conjunto de dados iris.
#| fig-height: 4
# Visualizando a densidade estimada para duas dimensões com GGPLOT
ggplot(densidade_df_pet, aes(x = Petal.Length, y = Petal.Width, fill = Density)) +
geom_tile() +
labs(title = "Estimativa de Densidade Kernel Multivariada",
x = "Petal Length",
y = "Petal Width") +
scale_fill_gradient(low = "white", high = "blue") +
theme_minimal()
#| label: setup
#| echo: false
#| message: false
#| warning: false
if (!("pacman" %in% installed.packages())){
install.packages("pacman")
}
pacman::p_load(tidyverse, cowplot, latex2exp, ks, class, PerformanceAnalytics, MASS, magrittr, reshape2)
#| label: fig-densidadeiris
#| fig-cap: Estimativa de densidade kernel para as variáveis do conjunto de dados iris.
#| fig-height: 3
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank())
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank(),
panel.border = element_blank())
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = 'black')))
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = 'gray'))
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank(),
panel.border = element_blank(),
axis.line = element_line(color = 'black'))
ggplot(densidade_total, aes(x = x, y = y, color = Variable)) +
geom_line() +
labs(x = "Valor da Variável",
y = "Densidade") +
theme_bw() +
theme(legend.title = element_blank(),
panel.border = element_blank(),
axis.line = element_line())
# Visualizando a densidade estimada para duas dimensões com GGPLOT
ggplot(densidade_df_sep, aes(x = Sepal.Length, y = Sepal.Width, fill = Density)) +
geom_tile() +
labs(x = "Sepal Length",
y = "Sepal Width") +
scale_fill_gradient(low = "white", high = "blue") +
theme_bw()
# Visualizando a densidade estimada para duas dimensões com GGPLOT
ggplot(densidade_df_sep, aes(x = Sepal.Length, y = Sepal.Width, fill = Density)) +
geom_tile() +
labs(x = "Sepal Length",
y = "Sepal Width") +
scale_fill_gradient(low = "white", high = "blue") +
theme_bw()+
theme(panel.grid = element_blank())
# Visualizando a densidade estimada para duas dimensões com GGPLOT
ggplot(densidade_df_pet, aes(x = Petal.Length, y = Petal.Width, fill = Density)) +
geom_tile() +
labs( x = "Petal Length",
y = "Petal Width") +
scale_fill_gradient(low = "white", high = "blue") +
theme_bw()+
theme(panel.grid = element_blank())
#| label: exemplo-mclustDA
data(faithful)
#| label: exemplo-mclustDA
data(faithful)
force(faithful)
View(faithful)
plot(faithful$waiting, faithful$eruptions)
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 0, slope = 1, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 0, slope = 1, color = "red")
#| label: exemplo-mclustDA
pacman::p_load(mclust, tidyverse)
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 0, slope = 1, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 45, slope = 1, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 40, slope = 1, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 42, slope = 1, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 42, slope = 2, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 42, slope = 10, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 42, slope = 15, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 42, slope = 12, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 42, slope = 13, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 35, slope = 13, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 20, slope = 13, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")
faithful %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B")) %>% glimpse()
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")+
geom_abline(intercept = 95, slope = -13, color = "blue")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")+
geom_abline(intercept = 95, slope = -15, color = "blue")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")+
geom_abline(intercept = 115, slope = -15, color = "blue")
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")+
geom_abline(intercept = 110, slope = -15, color = "blue")
dados <- faithful %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_2 = if_else(waiting > 110 + -15 * eruptions, "A", "B"))
dados %>%
ggplot(aes(x = eruptions, y = waiting, color = class_1)) +
geom_point()
dados %>%
ggplot(aes(x = eruptions, y = waiting, color = class_2)) +
geom_point()
dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))
dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
labs(color = "")
p1 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
labs(color = "")+
theme(legend.position = "bottom")
#p1 <-
dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
labs(color = "")+
theme(legend.position = "bottom")
#p1 <-
dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
labs(color = "")+
theme_bw()+
theme(legend.position = "bottom")
cowplot::plot_grid(p1, p2, nrow = 1)
p2 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
labs(color = "")+
theme_bw()+
theme(legend.position = "bottom")
cowplot::plot_grid(p1, p2, nrow = 1)
p1 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_1))+
labs(color = "")+
theme_bw()+
theme(legend.position = "bottom")
p2 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
labs(color = "")+
theme_bw()+
theme(legend.position = "bottom")
cowplot::plot_grid(p1, p2, nrow = 1)
p1 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_1))+
theme_bw()+
theme(legend.position = "none")
p2 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
theme_bw()+
theme(legend.position = "none")
cowplot::plot_grid(p1, p2, nrow = 1)
?plot_grid
#| label: exemplo-mclustDA
set.seed(123)
data(faithful)
ggplot(faithful, aes(x = eruptions, y = waiting)) +
geom_point() +
geom_abline(intercept = 25, slope = 13, color = "red")+
geom_abline(intercept = 110, slope = -15, color = "blue")
dados <- faithful %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_2 = if_else(waiting > 110 + -15 * eruptions, "A", "B"))
p1 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_1))+
theme_bw()+
theme(legend.position = "none")
p2 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
theme_bw()+
theme(legend.position = "none")
cowplot::plot_grid(p1, p2, nrow = 1)
dados <- data(faithful) %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_2 = if_else(waiting > 110 + -15 * eruptions, "A", "B"))
dados <- data(faithful) %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_2 = if_else(waiting > 110 + -15 * eruptions, "A", "B"))
?sample
dados <- faithful %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_2 = if_else(waiting > 110 + -15 * eruptions, "A", "B"),
treino = sample(c(0,1),
size = nrow(faithful),
prob = c(0.3, 0.7))
)
dados <- faithful %>%
mutate(class_1 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_2 = if_else(waiting > 110 + -15 * eruptions, "A", "B"),
treino = sample(c(0,1),
size = nrow(faithful),
prob = c(0.3, 0.7),
replace = TRUE)
)
sum(dados$treino)
nrow(faithful)
197/2
197/272
View(dados)
?plot_grid
p1 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_1))+
theme_bw()+
theme(legend.position = "none")
p2 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
theme_bw()+
theme(legend.position = "none")
cowplot::plot_grid(p1, p2, nrow = 1, labels = c("class_1", "class_2"))
dados <- faithful %>%
mutate(class_2 = if_else(waiting > 25 + 13 * eruptions, "A", "B"),
class_1 = if_else(waiting > 110 + -15 * eruptions, "A", "B"),
treino = sample(c(0,1),
size = nrow(faithful),
prob = c(0.3, 0.7),
replace = TRUE)
)
p1 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_1))+
theme_bw()+
theme(legend.position = "none")
p2 <- dados %>%
ggplot() +
geom_point(aes(x = eruptions, y = waiting, color = class_2))+
theme_bw()+
theme(legend.position = "none")
cowplot::plot_grid(p1, p2, nrow = 1, labels = c("class_1", "class_2"))
#| label: exemplo de dados
head(dados)
#| label: exemplo de dados
head(dados)
pacman::p_load(mclust, tidyverse, cowplot, magrittr)
?MclustDA
mod1 <- dados %>%
dplyr::filter(treino == 1) %$%
MclustDA(data = cbind(eruptions, waiting),
class = class_1)
mod2 <- dados %>%
dplyr::filter(treino == 1) %$%
MclustDA(data = cbind(eruptions, waiting),
class = class_2)
pacman::p_load(mclust, tidyverse, cowplot, magrittr, qrcode)
qrcode::qr_code("https://github.com/cesar-galvao/TE2-id-padroes") %>%
plot()
plot(mod1, what = "error")
plot(mod2, what = "error")
p3 <- plot(mod1, what = "classification")
p3
p4 <- plot(mod2, what = "error")
p4
plot(mod1, what = "classification")
plot(mod1, what = "error")
plot(mod2, what = "error")
glimpse(dados)
dados %>%
dplyr::filter(treino == 0) %$%
summary(mod1, newdata = c(eruptions, waiting), newclass = treino)
dados %>%
dplyr::filter(treino == 0) %$%
summary(mod1, newdata = tibble(eruptions, waiting), newclass = treino)
dados %>%
dplyr::filter(treino == 0) %$%
summary(mod1, newdata = tibble(eruptions, waiting), newclass = class_1)
dados %>%
dplyr::filter(treino == 0) %$%
summary(mod1, newdata = tibble(eruptions, waiting), newclass = class_2)
?cvMclustDA
#| label: cross-validation
cv1_loo <- cvMclustDA(mod1, nfold = 5)
cv2_loo <- cvMclustDA(mod2, nfold = 5)
#| label: cross-validation
cv1_loo <- cvMclustDA(mod1, nfold = nrow(dados))
cv2_loo <- cvMclustDA(mod2, nfold = nrow(dados))
cv2_loo <- cvMclustDA(mod2, nfold = nrow(dados))
cv1_5 <- cvMclustDA(mod1, nfold = 5)
cv1_5 <- cvMclustDA(mod1, nfold = 5)
cv2_5 <- cvMclustDA(mod2, nfold = 5)
ce_table <- tibble(
modelo = c("class_1", "class_2"),
LOO = c(cv1_loo$ce, cv2_loo$ce),
"5-fold" = c(cv1_5$ce, cv2_5$ce)
)
bs_table <- tibble(
modelo = c("class_1", "class_2"),
LOO = c(cv1_loo$bs, cv2_loo$bs),
"5-fold" = c(cv1_5$bs, cv2_5$bs)
)
#| label: print-cv
knitr::kable(ce_table, caption = "Erro de classificação")
knitr::kable(bs_table, caption = "Brier score")
cv1_5 <- cvMclustDA(mod1, nfold = 5)
cv2_5 <- cvMclustDA(mod2, nfold = 5)
cv2_loo$bs
bs_table <- tibble(
modelo = c("class_1", "class_2"),
LOO = c(cv1_loo$brier, cv2_loo$brier),
"5-fold" = c(cv1_5$brier, cv2_5$brier)
)
knitr::kable(bs_table, caption = "Brier score")
